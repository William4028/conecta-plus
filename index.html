<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ConectaPlus</title>

    <style>
      :root {
        --bg: #0f0f12;
        --card: #17171d;
        --text: #f2f2f2;
        --muted: #b8b8c2;
        --pink: #ff4d6d;
        --pink2: #ff2d55;
        --line: rgba(255, 255, 255, 0.08);
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        background: radial-gradient(1200px 800px at 70% 0%, rgba(255,77,109,.18), transparent 55%),
                    radial-gradient(900px 700px at 0% 20%, rgba(255,45,85,.12), transparent 55%),
                    var(--bg);
        color: var(--text);
        min-height: 100vh;
        display: grid;
        place-items: center;
        padding: 24px;
      }
      .wrap { width: 100%; max-width: 420px; }
      .brand {
        font-size: 34px;
        font-weight: 800;
        letter-spacing: .2px;
        margin: 0 0 14px;
      }
      .brand span { color: var(--pink); }
      .card {
        background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
        border: 1px solid var(--line);
        border-radius: 16px;
        padding: 18px;
        box-shadow: 0 12px 40px rgba(0,0,0,.35);
      }
      .muted { color: var(--muted); font-size: 14px; line-height: 1.4; margin: 0 0 14px; }
      .row { display: flex; gap: 10px; align-items: center; }
      .btn {
        width: 100%;
        border: 0;
        border-radius: 12px;
        padding: 14px 14px;
        font-weight: 700;
        cursor: pointer;
        display: inline-flex;
        gap: 10px;
        align-items: center;
        justify-content: center;
        transition: transform .06s ease, opacity .2s ease;
        user-select: none;
      }
      .btn:active { transform: scale(.98); }
      .btn.primary { background: linear-gradient(90deg, var(--pink), var(--pink2)); color: white; }
      .btn.ghost { background: rgba(255,255,255,.06); color: white; border: 1px solid var(--line); }
      .btn:disabled { opacity: .55; cursor: not-allowed; }
      .divider { height: 1px; background: var(--line); margin: 14px 0; }
      .userBox { display: none; gap: 12px; align-items: center; }
      .avatar {
        width: 52px; height: 52px; border-radius: 14px;
        background: rgba(255,255,255,.08);
        border: 1px solid var(--line);
        object-fit: cover;
      }
      .name { margin: 0; font-weight: 800; }
      .email { margin: 2px 0 0; color: var(--muted); font-size: 13px; }
      .status {
        display: inline-flex;
        padding: 6px 10px;
        border-radius: 999px;
        background: rgba(255,77,109,.14);
        border: 1px solid rgba(255,77,109,.25);
        color: #ffd1da;
        font-size: 12px;
        font-weight: 700;
      }
      .warn {
        margin-top: 12px;
        font-size: 12px;
        color: #ffd1da;
        opacity: .9;
      }
      .small { font-size: 12px; color: var(--muted); margin-top: 12px; }
      code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
    </style>
  </head>

  <body>
    <div class="wrap">
      <h1 class="brand">Conecta<span>Plus</span></h1>

      <div class="card">
        <p class="muted">
          Login rápido pra liberar seu perfil. Depois a gente coloca <b>Ficar / Namorar / Ver o que rola</b>.
        </p>

        <div id="loggedOut">
          <button id="btnGoogle" class="btn primary">
            <span>Entrar com Google</span>
          </button>

          <div class="warn" id="msg"></div>

          <div class="small">
            Se der erro de domínio, vamos ajustar em: <code>Firebase → Authentication → Configurações</code>.
          </div>
        </div>

        <div id="loggedIn" style="display:none;">
          <div class="row" style="justify-content:space-between; margin-bottom: 10px;">
            <span class="status">Logado ✅</span>
            <button id="btnLogout" class="btn ghost" style="width:auto; padding:10px 12px;">
              Sair
            </button>
          </div>

          <div class="row userBox" id="userBox">
            <img id="avatar" class="avatar" alt="Foto" />
            <div>
              <p class="name" id="name">—</p>
              <p class="email" id="email">—</p>
            </div>
          </div>

          <div class="divider"></div>

          <button id="btnGo" class="btn primary">
            Continuar
          </button>

          <p class="small">
            Próximo passo: salvar seu perfil no Firestore (nome + objetivo + cidade).
          </p>
        </div>
      </div>
    </div>

    <!-- Firebase (compat) - ideal pra GitHub Pages (sem bundler) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <script>
      // 1) COLE AQUI O firebaseConfig DO SEU PROJETO (Configuração do SDK -> Config)
      // Substitua tudo dentro do objeto abaixo.
      const firebaseConfig = {
        apiKey: "COLE_AQUI",
        authDomain: "COLE_AQUI",
        projectId: "COLE_AQUI",
        storageBucket: "COLE_AQUI",
        messagingSenderId: "COLE_AQUI",
        appId: "COLE_AQUI"
      };

      // 2) Inicializa
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();

      // 3) UI helpers
      const $ = (id) => document.getElementById(id);
      const msgEl = $("msg");
      const btnGoogle = $("btnGoogle");
      const btnLogout = $("btnLogout");
      const loggedOut = $("loggedOut");
      const loggedIn = $("loggedIn");
      const userBox = $("userBox");
      const nameEl = $("name");
      const emailEl = $("email");
      const avatarEl = $("avatar");

      function setMsg(text) {
        msgEl.textContent = text || "";
      }

      function showLoggedOut() {
        loggedOut.style.display = "block";
        loggedIn.style.display = "none";
        userBox.style.display = "none";
        setMsg("");
      }

      function showLoggedIn(user) {
        loggedOut.style.display = "none";
        loggedIn.style.display = "block";
        userBox.style.display = "flex";

        nameEl.textContent = user.displayName || "Sem nome";
        emailEl.textContent = user.email || "Sem e-mail";

        const photo = user.photoURL || "";
        avatarEl.src = photo || "data:image/svg+xml;charset=utf-8," + encodeURIComponent(`
          <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80">
            <rect width="100%" height="100%" rx="18" ry="18" fill="rgba(255,255,255,.08)"/>
            <text x="50%" y="52%" dominant-baseline="middle" text-anchor="middle"
              font-family="Arial" font-size="28" fill="rgba(255,255,255,.75)">CP</text>
          </svg>
        `);
      }

      // 4) Login Google
      btnGoogle.addEventListener("click", async () => {
        setMsg("");
        btnGoogle.disabled = true;

        try {
          const provider = new firebase.auth.GoogleAuthProvider();
          provider.setCustomParameters({ prompt: "select_account" });

          // Em celular às vezes bloqueia popup -> se falhar tenta redirect
          try {
            await auth.signInWithPopup(provider);
          } catch (popupErr) {
            // fallback redirect
            await auth.signInWithRedirect(provider);
          }
        } catch (err) {
          console.error(err);
          setMsg("Erro no login: " + (err?.message || "tente novamente"));
          btnGoogle.disabled = false;
        }
      });

      btnLogout.addEventListener("click", async () => {
        try {
          await auth.signOut();
        } catch (err) {
          console.error(err);
          alert("Erro ao sair: " + (err?.message || "tente novamente"));
        }
      });

      // Botão “Continuar” só pra teste (depois vira tela de perfil)
      $("btnGo").addEventListener("click", () => {
        alert("Boa! Próximo passo: criar tela de Perfil + salvar no Firestore.");
      });

      // 5) Observa login
      auth.onAuthStateChanged((user) => {
        btnGoogle.disabled = false;
        if (user) showLoggedIn(user);
        else showLoggedOut();
      });

      // 6) Se usou redirect, pega resultado
      auth.getRedirectResult().catch((err) => {
        console.error(err);
        setMsg("Erro no redirect: " + (err?.message || "tente novamente"));
      });
    </script>
  </body>
</html>
