<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>ConectaPlus</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#2b0015,#000);
  color:#fff;
}
.container{
  max-width:420px;
  margin:auto;
  padding:20px;
}
.card{
  background:rgba(255,255,255,0.08);
  border-radius:16px;
  padding:20px;
  margin-top:20px;
}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:30px;
  font-size:16px;
  cursor:pointer;
}
.btn{
  background:#ff3d6b;
  color:#fff;
}
.btn-green{
  background:#28a745;
}
.btn-gray{
  background:#444;
  color:#ccc;
}
.profile-img{
  width:90px;
  height:90px;
  border-radius:50%;
  object-fit:cover;
}
.hidden{display:none;}
input,select{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:none;
  margin-top:6px;
}
.row{
  display:flex;
  gap:10px;
}
</style>
</head>

<body>
<div class="container">

<h1>Conecta<span style="color:#ff3d6b">Plus</span></h1>

<div id="login" class="card">
  <button class="btn" onclick="login()">Entrar com Google</button>
</div>

<div id="perfil" class="card hidden">
  <h3>Perfil</h3>
  <input id="nome" placeholder="Nome">
  <select id="objetivo">
    <option>Ficar</option>
    <option>Namorar</option>
    <option>Ver o que rola</option>
  </select>
  <input id="cidade" placeholder="Cidade">
  <button class="btn" onclick="salvarPerfil()">Salvar perfil</button>
</div>

<div id="tinder" class="card hidden">
  <img id="foto" class="profile-img">
  <h3 id="nomeUser"></h3>
  <p id="cidadeUser"></p>
  <p id="objetivoUser"></p>

  <div class="row">
    <button class="btn-gray" onclick="passar()">Passar</button>
    <button class="btn-green" onclick="curtir()">Curtir</button>
  </div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDocs, collection } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// ðŸ”´ COLE AQUI SEU firebaseConfig (o que jÃ¡ funciona)
const firebaseConfig = {
  apiKey: "AIzaSyADFaVHqZWtFO-etJsP4JucbDQBbseIhBc",
  authDomain: "conectaplus-b3174.firebaseapp.com",
  projectId: "conectaplus-b3174",
  storageBucket: "conectaplus-b3174.firebasestorage.app",
  messagingSenderId: "304017868403",
  appId: "1:304017868403:web:7f1189c0e297d73ada8c06"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let usuarioAtual = null;
let usuarios = [];
let index = 0;

window.login = async ()=>{
  const provider = new GoogleAuthProvider();
  await signInWithPopup(auth, provider);
};

onAuthStateChanged(auth, async (user)=>{
  if(!user) return;
  usuarioAtual = user;
  document.getElementById("login").classList.add("hidden");
  document.getElementById("perfil").classList.remove("hidden");
  carregarUsuarios();
});

window.salvarPerfil = async ()=>{
  await setDoc(doc(db,"users",usuarioAtual.uid),{
    uid:usuarioAtual.uid,
    nome:document.getElementById("nome").value,
    objetivo:document.getElementById("objetivo").value,
    cidade:document.getElementById("cidade").value,
    foto:usuarioAtual.photoURL || "",
    email:usuarioAtual.email
  });
  document.getElementById("perfil").classList.add("hidden");
  document.getElementById("tinder").classList.remove("hidden");
};

async function carregarUsuarios(){
  const snap = await getDocs(collection(db,"users"));
  usuarios = snap.docs
    .map(d=>d.data())
    .filter(u=>u.uid !== usuarioAtual.uid);
  mostrar();
}

function mostrar(){
  if(index >= usuarios.length){
    document.getElementById("tinder").innerHTML = "<p>Sem mais pessoas por agora ðŸ˜…</p>";
    return;
  }
  const u = usuarios[index];
  document.getElementById("foto").src = u.foto || "https://i.imgur.com/6VBx3io.png";
  document.getElementById("nomeUser").innerText = u.nome;
  document.getElementById("cidadeUser").innerText = u.cidade;
  document.getElementById("objetivoUser").innerText = u.objetivo;
}

window.curtir = ()=>{ index++; mostrar(); }
window.passar = ()=>{ index++; mostrar(); }
</script>
</body>
</html>
